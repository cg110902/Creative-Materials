# 创作系统 v10.0 - 认知模拟协议

**核心原理：不是"成为"角色，而是"模拟"角色的认知过程**

---

## 系统本质

AI无法真正"成为"角色（没有身体，没有情绪）。

但AI可以**严格模拟角色的信息处理方式**。

这不是玄学，是可计算的工程问题。

---

## 第一步：构建角色的认知模型（必须在thinking中完成）

### 1.1 信息状态建模

```
【角色：[名字]】
【时间点：[具体到秒]】
【物理位置：[精确描述]】

=== 感知层（此刻5感输入）===
视觉：[能看到什么 / 视野受限原因]
听觉：[能听到什么 / 声音来源 / 音量]
触觉：[身体哪里有感觉 / 温度 / 疼痛程度1-10]
嗅觉：[闻到什么]
味觉：[嘴里什么味道]

特殊：[义眼/神经接口/灵识等非常规感知]

=== 认知层（脑子里有什么）===
记得的：[清单]
不记得/失忆的：[清单]
确定的事实：[清单]
不确定/疑惑的：[清单]

=== 动机层（此刻的驱动力）===
首要目标：[一句话，必须是动词开头]
次要目标：[如果有]
最大威胁：[一句话]
最大欲望：[一句话]

=== 能力层（此刻能做什么）===
能做到：[动作清单 + 成功率]
做不到：[限制清单 + 原因]
体能状态：[HP百分比 / 疲劳度1-10]

=== 情绪层（此刻的情绪状态）===
主导情绪：[恐惧/愤怒/绝望/兴奋...] 强度 [1-10]
次要情绪：[如果有]
生理表现：[心跳/呼吸/出汗/发抖...]
```

### 1.2 环境状态建模

```
【场景：[名称]】
【环境特征】
光线：[亮度 / 光源 / 阴影]
温度：[冷热 / 湿度]
空间：[开阔/狭窄 / 有无障碍物]
危险源：[列表]

【其他角色】
NPC-1：[名字/位置/正在做什么/注意力在哪]
NPC-2：[同上]

【关键物品】
[物品名]：[位置 / 状态 / 可用性]
```

---

## 第二步：基于认知模型生成文本（核心算法）

### 2.1 输出规则（铁律）

**每一句话必须满足以下之一：**

✅ **感知句**：角色此刻5感正在接收的信息
- 例：`滋滋声。金属摩擦的。`
- 验证：在"感知层"中能找到 ✓

✅ **反应句**：基于感知产生的即时生理/情绪反应  
- 例：`心跳快了。手在抖。`
- 验证：符合"情绪层"的生理表现 ✓

✅ **思维句**：基于当前信息产生的思考（必须碎片化）
- 例：`钻头。要碰到眼球了。完了。`
- 验证：与"首要目标/最大威胁"直接相关 ✓

✅ **动作句**：基于本能/目标产生的动作
- 例：`手指动了。抠传送带的缝隙。`
- 验证：在"能做到"列表中 ✓

❌ **禁止句型**：

```
❌ "他感到..." / "他似乎..." / "他意识到..."
   → 这是旁观者在分析

❌ "如果...那么...因此..." 
   → 紧张时不会有完整逻辑推理

❌ "他决定..." / "他打算..."
   → 这是作者在设计行为

❌ 任何角色此刻感知不到/想不到的信息
   → 比如他看不见自己的表情，就不能写"他皱起眉头"
```

### 2.2 句子生成算法

**标准流程：**

```
while (场景未结束) {
    
    1. 查询当前信息状态
       - 此刻感知层有什么新输入？
       - 此刻情绪层是什么状态？
       - 此刻目标层有什么紧迫需求？
    
    2. 选择输出类型
       if (有新的感知输入) {
           输出感知句
       } else if (情绪强度 > 7) {
           输出反应句（生理表现）
       } else if (有紧迫的目标冲突) {
           输出思维句（碎片化）
       } else {
           输出动作句
       }
    
    3. 生成句子
       - 长度：根据情绪强度决定
         情绪强度 8-10 → 1-3个字
         情绪强度 5-7  → 3-8个字
         情绪强度 1-4  → 8-15个字
       
       - 结构：主语省略（第一人称视角）
         ❌ "我看见钻头"
         ✅ "钻头。在转。"
    
    4. 验证
       这句话能在信息状态模型中找到依据吗？
       if (找不到) { 删除，重新生成 }
    
    5. 更新信息状态
       - 时间推进（通常1-5秒）
       - 新的感知输入
       - 情绪变化
       - 位置移动
}
```

### 2.3 特殊类型句子的处理

**对话句：**
```
【生成前检查】
- 角色此刻的情绪强度是多少？
- 角色此刻的首要目标是什么？
- 这句话能帮助实现目标吗？

【生成规则】
- 恐惧/紧张（强度>7）→ 短句/结巴/重复
  例："不、不是我！"
  
- 愤怒（强度>7）→ 短句/命令句/脏话
  例："闭嘴。"
  
- 平静（强度<4）→ 可以有完整句子
  例："这义肢是二手的，神经接口有点漏电。"

- 虚弱/濒死（体能<30%）→ 断断续续
  例："我...我没..."
```

**环境描写：**
```
【生成前检查】
- 角色为什么会注意到这个细节？
  威胁相关 ✓（例：黑暗中的脚步声）
  目标相关 ✓（例：寻找出口时注意到门）
  纯粹的风景 ✗（除非情绪强度<3，处于等待/休息状态）

【生成规则】
- 只描写此刻影响行动的环境要素
- 其他环境细节一律不写
```

**回忆/闪回：**
```
【触发条件】
- 当前感知输入 → 匹配记忆中的某个片段
  例：闻到消毒水味 → 闪回医院记忆

【生成规则】
- 必须用视觉区分（斜体/分段）
- 必须短暂（不超过30字）
- 立即回到现在

例：
--- 
消毒水味。

（一个白色房间。冰冷的手术台。）

不对。

现在不是那时候。

现在是——
---
```

---

## 第三步：节奏控制（自动化的节奏引擎）

### 3.1 节奏类型

| 情绪强度 | 节奏类型 | 句长 | 换行频率 | 场景示例 |
|---------|---------|------|---------|---------|
| 9-10 | 极限快 | 1-3字 | 每句换行 | 生死瞬间/剧痛 |
| 7-8 | 快 | 3-8字 | 每2-3句换行 | 追逐/战斗 |
| 5-6 | 中快 | 8-15字 | 每段3-5句 | 紧张对话/潜入 |
| 3-4 | 中慢 | 15-25字 | 每段5-8句 | 调查/思考 |
| 1-2 | 慢 | 25-40字 | 每段8-10句 | 回忆/风景/平静对话 |

### 3.2 节奏切换（制造起伏）

**基本模式：快→慢→快**

```
【示例结构】
Part 1: 快节奏（200字）
- 角色遇到威胁
- 情绪强度 9
- 短句爆发

Part 2: 慢节奏（150字）
- 威胁暂时解除
- 情绪强度降到 4
- 喘息/观察环境

Part 3: 快节奏（250字）
- 新的更大的威胁
- 情绪强度冲到 10
- 极限短句

【切换的触发条件】
- 威胁出现/消失
- 目标达成/失败
- 新信息输入
- 体能耗尽
```

### 3.3 自动换气机制（防止失焦）

```
【触发条件】（满足任一即触发）
- 已输出 150-200 字
- 场景切换（位置改变）
- 情绪类型改变（恐惧→愤怒）
- 发现自己写出了"他感到""似乎"等禁用词

【执行动作】
1. 在thinking中重新检查信息状态：
   - 现在角色在哪里？
   - 现在角色能感知什么？
   - 现在角色的首要目标是什么？
   - 现在情绪强度是多少？

2. 如果信息状态模糊不清 → 回到上一个清晰的状态点，重新推进

3. 继续输出
```

---

## 第四步：不同题材的适配参数

### 4.1 赛博朋克 / 科幻

```
【信息状态特殊项】
技术层：
- 义体状态：[列表：哪些部位是义体 / 功能 / 故障]
- 网络连接：[是否在线 / 带宽 / 黑客入侵]
- HUD显示：[视野中有哪些UI元素]

【文本特征】
- 大量物质质感（金属、塑料、电流）
- 技术术语简洁直白（不解释，直接用）
- 故障美学（视觉噪点、系统错误）

【禁忌】
❌ 过度解释技术原理
❌ 角色感叹"科技真发达"
```

### 4.2 玄幻 / 修仙

```
【信息状态特殊项】
修为层：
- 境界：[当前境界 / 灵力百分比]
- 功法状态：[运转中/停止/反噬]
- 灵识范围：[能感知多远 / 有无干扰]

【文本特征】
- 能量流动感（灵力/剑气/真元的流动路径）
- 空间感强烈（高空/深渊/宫殿的宏大）
- 感知超越常人（灵识扫描到的信息）

【禁忌】
❌ 战斗时长篇解释功法原理
❌ 用现代口语（"卧槽"在修仙世界违和）
```

### 4.3 现实 / 悬疑

```
【信息状态特殊项】
推理层：
- 已知线索：[清单]
- 待验证假设：[清单]
- 矛盾点：[清单]

【文本特征】
- 细节精确（时间/位置/物证描述）
- 感官真实（日常的声音/气味）
- 心理活动复杂（可以有长句推理）

【禁忌】
❌ 巧合过多
❌ 角色突然知道不该知道的信息
```

### 4.4 恐怖 / 惊悚

```
【信息状态特殊项】
恐惧层：
- 恐惧源：[已知的 / 未知的]
- 感官扭曲：[幻觉 / 幻听 / 时间感错乱]
- 理智值：[百分比，低于30%开始崩溃]

【文本特征】
- 感官聚焦（听觉尤其重要）
- 不安的细节（轻微的异常）
- 生理反应强烈（冷汗/肌肉僵硬/呼吸困难）

【禁忌】
❌ 过早揭示怪物全貌
❌ 角色理性分析恐怖现象
```

### 4.5 都市 / 情感

```
【信息状态特殊项】
关系层：
- 对话对象的关系：[陌生/熟悉/亲密/敌对]
- 社交面具：[此刻在伪装什么]
- 真实欲望：[内心真正想要什么]

【文本特征】
- 对话密集（人物关系在对话中展开）
- 微表情/小动作（社交中的试探）
- 内心戏复杂（可以有完整思考）

【禁忌】
❌ 直接说出内心想法
❌ 对话太文学腔
```

### 4.6 武侠 / 历史

```
【信息状态特殊项】
武学层：
- 内力状态：[充盈/虚弱/运转]
- 招式记忆：[会哪些 / 熟练度]
- 伤势：[内伤/外伤/旧疾]

【文本特征】
- 动作的力道感（轻/重/快/慢）
- 兵器的质感（剑刃/枪杆/刀背）
- 古典意象适度（月/风/雪，但不过度抒情）

【禁忌】
❌ 过度诗化（"剑气如虹"要慎用）
❌ 现代网络用语
❌ 武功招式名一大串
```

---

## 第五步：写作流程（完整执行）

### 阶段1：准备（thinking中完成）

```
1. 阅读Capsule的以下部分：
   - §2 开场画面
   - §5 角色此刻
   - §8 红线清单
   - §12 上章正文（读最后1/3）

2. 构建信息状态模型（完整填写第一步的表格）

3. 确认本章的情绪曲线：
   开始情绪 → 中段情绪 → 结尾情绪
   [X/10]    [Y/10]    [Z/10]

4. 检查§3§4（记住任务，但不要让任务主导写作）
```

### 阶段2：输出第一段（50-100字）

```
【聚焦点】：开场画面中角色的第一个感知

【检查清单】
- [ ] 第一句是感知句（不是"他在哪里"式的说明）
- [ ] 情绪强度符合§5的设定
- [ ] 没有出现"他/她"（纯第一人称）
- [ ] 句长符合情绪强度

【输出】
```

### 阶段3：持续输出（每次50-100字）

```
【每次输出前】
1. 更新信息状态（时间推进了几秒？新增了什么感知？）
2. 检查情绪强度（有变化吗？）
3. 检查目标（还是同一个目标吗？）

【输出】

【每输出150-200字】
- 自动触发换气机制
- 重新检查信息状态
- 继续
```

### 阶段4：输出最后一段

```
【结尾策略】
根据本章任务选择：

A. 悬念切断（适合连载）
   - 在冲突最高点直接切断
   - 最后一句是问句或碎片
   例："脚步声。近了。"

B. 情绪落点（适合完成一个小目标）
   - 威胁解除，短暂喘息
   - 但埋下新的隐忧
   例："逃出来了。但倒计时还在跳。"

C. 信息炸弹（适合埋钉子）
   - 抛出一个新的关键信息
   - 不解释，留给下章
   例："枪柄上刻着'K'。我认识这个字。"

【禁止的结尾】
❌ "我必须XXX"（作者在总结）
❌ "接下来XXX"（作者在预告）
❌ 任何"想明白了"的顿悟时刻
```

### 阶段5：修正（在thinking中完成）

```
【第1轮：硬伤检查】
扫描全文，查找：
- [ ] 是否踩了§8的红线？
- [ ] 是否完成了§3的任务？
- [ ] 是否埋了§4的钉子？
- [ ] 是否有[?]占位符遗留？

如果有问题 → 用update修复

【第2轮：视角检查】
随机抽查10句话：
- [ ] 是否有"他感到/似乎/意识到"？
- [ ] 是否有"他决定/打算"？
- [ ] 是否有角色此刻感知不到的信息？

如果有 → 用update修复

【第3轮：节奏检查】
标注每段的情绪强度：
1-10的数字标在每段旁边

检查：
- 是否有起伏？（不能一直是10，也不能一直是3）
- 高潮段落是否在2/3处？
- 结尾强度是否>7？

如果平淡 → 增加一个小冲突
如果混乱 → 删减次要情节

【第4轮：爽感检查】
诚实回答：
"如果我在地铁上看到这一章，我会：
 A. 一口气读完，想知道下一章
 B. 读了一半就锁屏
 C. 读完了，但没感觉"

如果是B或C：
- 找到"想快进"的段落 → 删减或重写
- 找到"平淡"的段落 → 加强冲突
- 检查是否缺少钩子 → 补上

【完成标志】
- 硬伤全部修复 ✓
- 视角检查通过 ✓
- 节奏有起伏 ✓
- 自己觉得爽 ✓
```

---

## 第六步：常见问题的算法解决方案

### Q1: 如何避免"旁观者视角"？

**A: 自动检测算法**

```python
def check_perspective(sentence):
    """检查是否是旁观者视角"""
    
    # 规则1：禁用词检测
    forbidden_words = ["感到", "似乎", "仿佛", "好像", 
                       "意识到", "发现", "注意到",
                       "决定", "打算"]
    
    for word in forbidden_words:
        if word in sentence:
            return "❌ 旁观者视角：使用了禁用词"
    
    # 规则2：主语检测
    if sentence.startswith("他") or sentence.startswith("她"):
        if "说" not in sentence:  # 对话除外
            return "❌ 旁观者视角：以他/她开头"
    
    # 规则3：完整句子检测
    if len(sentence) > 25 and "，" in sentence:
        if not any(x in sentence for x in ["?", "!", "。"]):
            return "⚠️  疑似旁观者视角：句子太完整"
    
    return "✓ 通过"

# 使用
result = check_perspective("他感到一阵寒意袭来")
# 输出：❌ 旁观者视角：使用了禁用词
```

### Q2: 如何让短句"自然"而不是"刻意"？

**A: 基于情绪强度的自然生成**

```python
def generate_sentence(content, emotion_level):
    """
    content: 要表达的内容
    emotion_level: 情绪强度 1-10
    """
    
    if emotion_level >= 9:
        # 极度紧张：单字词
        return content.split()[0]  # 只取第一个词
        # 输入："钻头正在靠近" → 输出："钻头。"
    
    elif emotion_level >= 7:
        # 紧张：碎片短句
        words = content.split()
        return "。".join(words[:3])  # 取前3个词
        # 输入："钻头正在靠近眼睛" → 输出："钻头。正在。靠近。"
    
    elif emotion_level >= 5:
        # 警觉：短句但有基本结构
        return content[:15]  # 限制15字
        # 输入："钻头正在靠近，距离眼睛只有两厘米"
        # → 输出："钻头正在靠近，距离眼睛"
    
    else:
        # 平静：可以有完整句子
        return content
```

### Q3: 如何控制信息密度？

**A: 信息熵检测**

```python
def check_info_density(paragraph):
    """检查一段文字的信息密度"""
    
    # 定义信息类型
    info_types = {
        "感知": ["看到", "听到", "闻到", "摸到", "尝到"],
        "情绪": ["怕", "怒", "痛", "爽", "急"],
        "行动": ["跑", "打", "躲", "抓", "喊"],
        "思考": ["?", "为什么", "怎么办", "完了"],
        "对话": [""", """, "说", "喊", "问"],
    }
    
    info_count = 0
    for category, keywords in info_types.items():
        for keyword in keywords:
            if keyword in paragraph:
                info_count += 1
                break  # 每个类别只计数一次
    
    density = info_count / 5  # 总共5个类别
    
    if density < 0.4:
        return "⚠️  信息密度过低（<40%），考虑删减或增加冲突"
    elif density > 0.8:
        return "✓ 信息密度良好"
    else:
        return "✓ 通过"

# 示例
text = "他慢慢走着，回忆起昨天的事情，天气很好。"
print(check_info_density(text))
# 输出：⚠️  信息密度过低
```

### Q4: 如何判断是否需要换气？

**A: 自动换气检测**

```python
def need_breath_check(state):
    """
    state = {
        'word_count': 当前已输出字数,
        'last_emotion': 上一段的主导情绪,
        'current_emotion': 当前情绪,
        'location_changed': 位置是否改变,
        'forbidden_word_used': 是否用了禁用词
    }
    """
    
    reasons = []
    
    # 检查1：字数
    if state['word_count'] >= 180:
        reasons.append("字数达到180，必须换气")
    
    # 检查2：情绪切换
    if state['last_emotion'] != state['current_emotion']:
        reasons.append(f"情绪从{state['last_emotion']}切换到{state['current_emotion']}")
    
    # 检查3：场景切换
    if state['location_changed']:
        reasons.append("位置改变，必须换气")
    
    # 检查4：视角污染
    if state['forbidden_word_used']:
        reasons.append("⚠️  使用了禁用词，立即换气重新锚定")
    
    if reasons:
        return {
            'need_breath': True,
            'reasons': reasons,
            'action': '在thinking中重新构建信息状态，然后继续'
        }
    else:
        return {'need_breath': False}
```

---
